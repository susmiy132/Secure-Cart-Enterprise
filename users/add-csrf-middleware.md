Add CSRF protection middleware

Files: middleware/csrf.ts, server.ts

Issue and validate CSRF tokens for stateful endpoints to prevent CSRF attacks.